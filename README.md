# WordPress Personal Blog

This repository contains a WordPress instaTriggering the deployment:
- **Automatic**: Push commits to the `main` branch that touch `wp-content/**` or `.htaccess`
- **Manual**: Run the workflow from the GitHub "Actions" tab (`workflow_dispatch`)
  - Regular manual deploy: Deploys changed files from last commit
  - Force full deploy: Check "Force full deployment" option to deploy everything

After a run, check the workflow logs for deployment summary and verify the updated files on GoDaddy. WordPress cache will be automatically flushed via WP-CLI (if available) or file deletion.

**Note**: If you use Cloudflare CDN, you may need to manually purge the Cloudflare cache from their dashboard after deployment to see changes immediately.on with a custom theme, helper plugin, and deployment automation for GoDaddy hosting. Use Docker Compose for local development, GitHub Actions for shipping updates to a live GoDaddy site, and the bundled Nextend Social Login integration to offer Google sign-in.

All content generated by AI

## Local Development (Docker Compose)

### Prerequisites
- Docker Desktop (or compatible Docker Engine) with Compose support.

### Start the stack
```bash
docker compose up -d
```
- WordPress is available at http://localhost:8080.
- First launch triggers the standard WordPress installer‚Äîcreate an admin account as prompted.
- Default database credentials (provisioned in Compose):
  - host: `db`
  - name/user/password: `wordpress`

Composer creates two persistent volumes:
- `./wp-content` mounts straight into the container so theme/plugin edits are reflected live.
- `db_data` keeps MySQL data between restarts. To reset everything, run `docker compose down -v`.

### Useful commands
- Stop containers: `docker compose stop`
- Remove containers (keeping volumes): `docker compose down`
- Tail logs: `docker compose logs -f wordpress`

```
Adjust the container name if you renamed the project.

## Deploy to GoDaddy with GitHub Actions

The workflow in `.github/workflows/deploy-wp-content.yml` syncs `wp-content` to an existing GoDaddy WordPress site with intelligent incremental deployments and automatic WordPress cache flushing.

### ‚ö° New Features

- **Incremental Deployments**: Only changed files are deployed (5-10x faster!)
- **Automatic WordPress Cache Flush**: Cache cleared automatically after deployment via WP-CLI or file deletion
- **Deployment Summaries**: See exactly what files were deployed
- **Full & Incremental Modes**: Choose your deployment strategy

üìñ **See [IMPROVED_DEPLOYMENT_GUIDE.md](./IMPROVED_DEPLOYMENT_GUIDE.md) for complete documentation**

### Quick Setup

Before you push to `main` or trigger a manual run, configure these repository secrets in GitHub:

| Secret | Purpose | Required |
| --- | --- | --- |
| `GD_SFTP_HOST` | GoDaddy SFTP hostname | ‚úÖ Yes |
| `GD_SFTP_USER` | SFTP username | ‚úÖ Yes |
| `GD_SFTP_PASSWORD` | SFTP password | ‚úÖ Yes |
| `GD_SFTP_PORT` (optional) | SFTP port, defaults to `22` | No |
| `GD_REMOTE_PATH` | Root directory of your GoDaddy WordPress install (e.g. `html`) | ‚úÖ Yes |

### How it Works

1. **Detects changed files** using `git diff` (compares HEAD~1 with HEAD)
2. **Creates optimized archive** with only changed files
3. **Uploads via SCP** to GoDaddy's `/tmp` directory
4. **Deploys via SSH** with automatic backup and safe sync
5. **Flushes WordPress cache** automatically via WP-CLI (if available) or file deletion
6. **Shows deployment summary** with list of deployed files

Triggering the deployment:
- Push commits to the `main` branch that touch `wp-content/**`.
- Or run the workflow manually from the GitHub ‚ÄúActions‚Äù tab (`workflow_dispatch`).

After a run, check the workflow logs and verify the updated files on GoDaddy before clearing caches.

## Google Sign-In Configuration

The repository bundles the Nextend Social Login plugin (`wp-content/plugins/nextend-facebook-connect`) and a must-use loader (`wp-content/mu-plugins/social-login-bootstrap.php`) that reads credentials from environment variables or constants.

### 1. Activate the plugin
- In `wp-admin`, go to Plugins ‚Üí Installed Plugins and ensure **Nextend Social Login** is activated. The MU plugin loads automatically once Nextend is active.

### 2. Create Google OAuth credentials
1. Open Google Cloud Console ‚Üí APIs & Services ‚Üí Credentials.
2. Configure the OAuth consent screen and add `tuno.world` as an Authorized domain (verify ownership if prompted).
3. Create OAuth credentials of type **Web application**.
4. Add redirect URIs that match your environments:
   - Production: `https://yourdomain.com/wp-login.php?loginSocial=google`
   - Local (optional): `http://localhost:8080/wp-login.php?loginSocial=google`
5. Note the generated Client ID and Client Secret.

### 3. Provide credentials to WordPress
Supply the keys via `wp-config.php` or environment variables. Any of the following names work (the loader checks all of them):
```php
define('SOCIAL_LOGIN_GOOGLE_CLIENT_ID', 'your-google-client-id');
define('SOCIAL_LOGIN_GOOGLE_CLIENT_SECRET', 'your-google-client-secret');
```
You can also set `GOOGLE_OAUTH_CLIENT_ID` / `GOOGLE_OAUTH_CLIENT_SECRET` as environment variables in Docker, on GoDaddy, or via your hosting control panel.

After saving the credentials, visit `wp-admin ‚Üí Nextend Social Login ‚Üí Providers ‚Üí Google` and click ‚ÄúVerify Settings‚Äù to confirm Google recognizes the redirect URI. Once verified, a ‚ÄúContinue with Google‚Äù button appears on `/wp-login.php` and any other login forms.

### 4. Test the flow
- Browse to https://yourdomain.com/wp-login.php?loginSocial=google and ensure Google renders the consent screen.
- If you see `Error 400: redirect_uri_mismatch`, confirm the URI matches exactly (scheme, host, path, query) in Google Cloud Console.

## Additional Notes
- Custom theme files live in `wp-content/themes/my-custom-theme`.
- Custom functionality is in `wp-content/plugins/my-custom-plugin`.
- The `build` directory includes artifacts for manual deployments if needed (GoDaddy package, database dump).
